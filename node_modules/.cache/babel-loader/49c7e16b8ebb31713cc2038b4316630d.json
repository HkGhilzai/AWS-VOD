{"ast":null,"code":"var _jsxFileName = \"/home/ec2-user/SignedUrl/UnicornFlix/src/components/Admin/index.jsx\";\n\n/* eslint-disable import/order */\n\n/* eslint-disable no-underscore-dangle */\nimport React from 'react';\nimport './index.css';\nimport uuidv4 from 'uuid/v4';\nimport FilePicker from '../FilePicker';\nimport PopoverProgress from '../PopoverProgress'; // Insert Location 2\n\nimport { withAuthenticator } from 'aws-amplify-react'; // Insert Location 4\n\nimport Amplify, { Auth, API, graphqlOperation, Storage } from 'aws-amplify';\nimport awsvideoconfig from '../../aws-video-exports';\nimport { createVodAsset, createVideoObject } from '../../graphql/mutations';\n\nclass Admin extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.myCallback = dataFromChild => {\n      this.setState({\n        file: dataFromChild,\n        fileName: dataFromChild.name\n      });\n    };\n\n    this.state = {\n      titleVal: '',\n      descVal: '',\n      groups: [],\n      progress: 0\n    };\n    this.submitFormHandler = this.submitFormHandler.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.createAdminPanel = this.createAdminPanel.bind(this);\n  }\n\n  componentDidMount() {\n    // Insert Location 5\n    const region = Amplify._config.aws_project_region;\n    Auth.currentSession().then(data => {\n      const groups = data.idToken.payload['cognito:groups'];\n\n      if (groups) {\n        this.setState({\n          groups: data.idToken.payload['cognito:groups']\n        });\n      }\n    });\n    Storage.configure({\n      AWSS3: {\n        bucket: awsvideoconfig.awsInputVideo,\n        region\n      }\n    });\n  }\n\n  handleChange(event) {\n    const value = event.target.value;\n    const name = event.target.name;\n    this.setState({\n      [name]: value\n    });\n  }\n\n  handledescChange(event) {\n    this.setState({\n      descVal: event.target.value\n    });\n  }\n\n  submitFormHandler(event) {\n    event.preventDefault(); // Insert Location 6\n\n    const uuid = uuidv4();\n    const adminPanel = this;\n    const videoObject = {\n      input: {\n        id: uuid\n      }\n    };\n    API.graphql(graphqlOperation(createVideoObject, videoObject)).then((response, error) => {\n      if (error === undefined) {\n        const _this$state = this.state,\n              titleVal = _this$state.titleVal,\n              descVal = _this$state.descVal,\n              file = _this$state.file,\n              fileName = _this$state.fileName;\n        const fileExtension = fileName.toLowerCase().split('.');\n        const videoAsset = {\n          input: {\n            title: titleVal,\n            description: descVal,\n            vodAssetVideoId: uuid\n          }\n        };\n        API.graphql(graphqlOperation(createVodAsset, videoAsset));\n        Storage.put(`${uuid}.${fileExtension[fileExtension.length - 1]}`, file, {\n          progressCallback(progress) {\n            const loaded = progress.loaded,\n                  total = progress.total;\n            console.log(`Uploaded: ${progress.loaded}/${progress.total}`);\n            adminPanel.setState({\n              progress: loaded / total * 100\n            });\n          },\n\n          contentType: 'video/*'\n        }).then(() => console.log(`Successfully Uploaded: ${uuid}`)).catch(err => console.log(`Error: ${err}`));\n      }\n    });\n  }\n\n  createAdminPanel() {\n    const _this$state2 = this.state,\n          groups = _this$state2.groups,\n          titleVal = _this$state2.titleVal,\n          descVal = _this$state2.descVal,\n          progress = _this$state2.progress;\n\n    if (groups.includes('Admin')) {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(\"header\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"pageName\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, \"Admin Panel\"), React.createElement(\"form\", {\n        onSubmit: this.submitFormHandler,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        value: titleVal,\n        name: \"titleVal\",\n        placeholder: \"Title\",\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }), React.createElement(\"textarea\", {\n        className: \"desTextA\",\n        rows: \"4\",\n        cols: \"50\",\n        value: descVal,\n        name: \"descVal\",\n        placeholder: \"Description\",\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }), React.createElement(FilePicker, {\n        callbackFromParent: this.myCallback,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"submitButton\",\n        className: \"submitLabel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, \"Create Asset\", React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"submitButton\",\n        id: \"submitButton\",\n        value: \"Create Asset\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      })), React.createElement(PopoverProgress, {\n        progress: progress,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      })))));\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, \"Not Authenticated\");\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"adminHeader\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, this.createAdminPanel());\n  }\n\n} // Insert Location 3\n\n\nexport default withAuthenticator(Admin, true);","map":{"version":3,"sources":["/home/ec2-user/SignedUrl/UnicornFlix/src/components/Admin/index.jsx"],"names":["React","uuidv4","FilePicker","PopoverProgress","withAuthenticator","Amplify","Auth","API","graphqlOperation","Storage","awsvideoconfig","createVodAsset","createVideoObject","Admin","Component","constructor","props","myCallback","dataFromChild","setState","file","fileName","name","state","titleVal","descVal","groups","progress","submitFormHandler","bind","handleChange","createAdminPanel","componentDidMount","region","_config","aws_project_region","currentSession","then","data","idToken","payload","configure","AWSS3","bucket","awsInputVideo","event","value","target","handledescChange","preventDefault","uuid","adminPanel","videoObject","input","id","graphql","response","error","undefined","fileExtension","toLowerCase","split","videoAsset","title","description","vodAssetVideoId","put","length","progressCallback","loaded","total","console","log","contentType","catch","err","includes","render"],"mappings":"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","sourcesContent":["/* eslint-disable import/order */\n/* eslint-disable no-underscore-dangle */\nimport React from 'react';\nimport './index.css';\nimport uuidv4 from 'uuid/v4';\nimport FilePicker from '../FilePicker';\nimport PopoverProgress from '../PopoverProgress';\n\n// Insert Location 2\nimport { withAuthenticator } from 'aws-amplify-react';\n\n\n// Insert Location 4\nimport Amplify, {\n  Auth, API, graphqlOperation, Storage,\n} from 'aws-amplify';\nimport awsvideoconfig from '../../aws-video-exports';\nimport { createVodAsset, createVideoObject } from '../../graphql/mutations';\n\n\n\nclass Admin extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      titleVal: '', descVal: '', groups: [], progress: 0,\n    };\n    this.submitFormHandler = this.submitFormHandler.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.createAdminPanel = this.createAdminPanel.bind(this);\n  }\n\n  componentDidMount() {\n    // Insert Location 5\nconst region = Amplify._config.aws_project_region;\nAuth.currentSession()\n  .then((data) => {\n    const groups = data.idToken.payload['cognito:groups'];\n    if (groups) {\n      this.setState({ groups: data.idToken.payload['cognito:groups'] });\n    }\n  });\n\nStorage.configure({\n  AWSS3: {\n    bucket: awsvideoconfig.awsInputVideo,\n    region,\n  },\n});\n  }\n\n  myCallback = (dataFromChild) => {\n    this.setState({\n      file: dataFromChild,\n      fileName: dataFromChild.name,\n    });\n  }\n\n  handleChange(event) {\n    const { value } = event.target;\n    const { name } = event.target;\n    this.setState({\n      [name]: value,\n    });\n  }\n\n  handledescChange(event) {\n    this.setState({ descVal: event.target.value });\n  }\n\n\n  submitFormHandler(event) {\n    event.preventDefault();\n    // Insert Location 6\nconst uuid = uuidv4();\nconst adminPanel = this;\nconst videoObject = {\n  input: {\n    id: uuid,\n  },\n};\n\nAPI.graphql(graphqlOperation(createVideoObject, videoObject)).then((response, error) => {\n  if (error === undefined) {\n    const {\n      titleVal, descVal, file, fileName,\n    } = this.state;\n    const fileExtension = fileName.toLowerCase().split('.');\n    const videoAsset = {\n      input: {\n        title: titleVal,\n        description: descVal,\n        vodAssetVideoId: uuid,\n      },\n    };\n    API.graphql(graphqlOperation(createVodAsset, videoAsset));\n    Storage.put(`${uuid}.${fileExtension[fileExtension.length - 1]}`, file, {\n      progressCallback(progress) {\n        const { loaded, total } = progress;\n        console.log(`Uploaded: ${progress.loaded}/${progress.total}`);\n        adminPanel.setState({\n          progress: (loaded / total) * 100,\n        });\n      },\n      contentType: 'video/*',\n    })\n      .then(() => console.log(`Successfully Uploaded: ${uuid}`))\n      .catch((err) => console.log(`Error: ${err}`));\n  }\n});\n    \n  }\n\n  createAdminPanel() {\n    const {\n      groups,\n      titleVal,\n      descVal,\n      progress,\n    } = this.state;\n    if (groups.includes('Admin')) {\n      return (\n        <div>\n          <header>\n            <h1 className=\"pageName\">Admin Panel</h1>\n            <form onSubmit={this.submitFormHandler}>\n              <div>\n                <input type=\"text\" value={titleVal} name=\"titleVal\" placeholder=\"Title\" onChange={this.handleChange} />\n                <br />\n                <textarea className=\"desTextA\" rows=\"4\" cols=\"50\" value={descVal} name=\"descVal\" placeholder=\"Description\" onChange={this.handleChange} />\n                <br />\n                <FilePicker callbackFromParent={this.myCallback} />\n                <label htmlFor=\"submitButton\" className=\"submitLabel\">\n                  Create Asset\n                  <input type=\"submit\" className=\"submitButton\" id=\"submitButton\" value=\"Create Asset\" />\n                </label>\n                <PopoverProgress progress={progress} />\n              </div>\n            </form>\n          </header>\n        </div>\n      );\n    }\n    return (\n      <div>\n        Not Authenticated\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div className=\"adminHeader\">\n        {this.createAdminPanel()}\n      </div>\n    );\n  }\n}\n// Insert Location 3\nexport default withAuthenticator(Admin, true);\n"]},"metadata":{},"sourceType":"module"}